{"version":3,"sources":["uni-app:///main.js","webpack:////Users/bin/Downloads/sns/pages/detail/detail.vue?589a","webpack:////Users/bin/Downloads/sns/pages/detail/detail.vue?e7c5","webpack:////Users/bin/Downloads/sns/pages/detail/detail.vue?8a4e","webpack:////Users/bin/Downloads/sns/pages/detail/detail.vue?1d57","uni-app:///pages/detail/detail.vue"],"names":["createPage","Page"],"mappings":"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","file":"pages/detail/detail.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/detail/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=3e159eb4&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/detail/detail.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=template&id=3e159eb4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l1 = _vm.__map(_vm.comments, function(item, index) {\n    var f0 = _vm._f(\"formatAvatar\")(item.avatar)\n\n    var f1 = _vm._f(\"formatTime\")(item.created_at)\n\n    var l0 = _vm.__map(item.reply, function(item1, index1) {\n      var f2 = _vm._f(\"formatAvatar\")(item1.avatar)\n\n      var f3 = _vm._f(\"formatTime\")(item1.created_at)\n\n      return {\n        $orig: _vm.__get_orig(item1),\n        f2: f2,\n        f3: f3\n      }\n    })\n\n    return {\n      $orig: _vm.__get_orig(item),\n      f0: f0,\n      f1: f1,\n      l0: l0\n    }\n  })\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l1: l1\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<!-- 帖子详情页详细信息 -->\r\n\t\t<common-list :item=\"info\" isdetail @follow=\"follow\" @doSupport=\"doSupport\" @doComment=\"doComment\" @doShare=\"doShare\"></common-list>\r\n\r\n\t\t<divider></divider>\r\n\t\t<view class=\"p-2 font-md font-weight-bold\">\r\n\t\t\t最新评论 {{info.comment_count}}\r\n\t\t</view>\r\n\t\t<view class=\"px-2\">\r\n\t\t\t<view v-for=\"(item,index) in comments\" :key=\"index\">\n\t\t\t\t<view class=\"uni-comment-list flex w-100\">\n\t\t\t\t\t<view class=\"uni-comment-face\">\n\t\t\t\t\t\t<image class=\"w-100\" mode=\"widthFix\" :src=\"item.avatar|formatAvatar\"></image>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"uni-comment-body\">\n\t\t\t\t\t\t<view class=\"uni-comment-top\">\n\t\t\t\t\t\t\t<text>{{item.username}}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"uni-comment-content\" @click=\"reply(item.id, item.id)\">{{item.content}}</view>\n\t\t\t\t\t\t<view class=\"uni-comment-date\">\n\t\t\t\t\t\t\t<view>{{item.created_at|formatTime}}</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<template v-if=\"item.reply.length > 0\">\n\t\t\t\t\t<view class=\"uni-comment-list\" v-for=\"(item1,index1) in item.reply\" :key=\"index1\">\n\t\t\t\t\t\t<view style=\"width: 60rpx;\"></view>\n\t\t\t\t\t\t<view class=\"flex w-100 bg-light rounded p-2\">\n\t\t\t\t\t\t\t<view class=\"uni-comment-face\">\n\t\t\t\t\t\t\t\t<image class=\"w-100\" mode=\"widthFix\" :src=\"item1.avatar|formatAvatar\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"uni-comment-body\">\n\t\t\t\t\t\t\t\t<view class=\"uni-comment-top\">\n\t\t\t\t\t\t\t\t\t<text>{{item1.username}}</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"uni-comment-content\" @click=\"reply(item.id, item1.id)\">{{item1.content}}</view>\n\t\t\t\t\t\t\t\t<view class=\"uni-comment-date\">\n\t\t\t\t\t\t\t\t\t<view>{{item1.created_at|formatTime}}</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</template>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\r\n\t\t<!-- 占位 -->\r\n\t\t<view style=\"height: 100rpx;\"></view>\r\n\t\t<bottom-input :focus=\"focus\" @blur=\"blur\" @submit=\"submit\"></bottom-input>\r\n\r\n\t\t<more-share ref=\"share\"></more-share>\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport commonList from '@/components/common/common-list.vue';\r\n\timport bottomInput from '@/components/common/bottom-input.vue';\r\n\timport moreShare from '@/components/common/more-share.vue';\r\n\timport $T from '@/common/time.js';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tcommonList,\r\n\t\t\tbottomInput,\r\n\t\t\tmoreShare\r\n\t\t},\n\t\tfilters: {\n\t\t\tformatTime(value) {\n\t\t\t\treturn $T.gettime(value);\n\t\t\t},\n\t\t\tformatAvatar(value) {\n\t\t\t\tif (value == \"\") {\n\t\t\t\t\treturn value = \"/static/default.jpg\";\n\t\t\t\t} else {\n\t\t\t\t\treturn value\n\t\t\t\t}\n\t\t\t},\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 当前帖子信息\r\n\t\t\t\tinfo: {\n\t\t\t\t\timage:[],\n\t\t\t\t\tstate:{}\n\t\t\t\t},\r\n\t\t\t\timages: [],\r\n\t\t\t\tcomments: [],\r\n\t\t\t\tfocus: false,\r\n\t\t\t\treply_id: 0,\n\t\t\t\treply_root:0\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\t// 初始化\r\n\t\t\tif (e.id) {\r\n\t\t\t\tthis.__init(e.id)\r\n\t\t\t}\r\n\t\t\t// 监听关注和顶踩操作\r\n\t\t\tuni.$on('updateFollowOrSupport', (e) => {\r\n\t\t\t\tswitch (e.type) {\r\n\t\t\t\t\tcase 'follow': // 关注\r\n\t\t\t\t\t\tthis.follow()\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'support': // 顶踩\r\n\t\t\t\t\t\tthis.doSupport(e.data)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('updateFollowOrSupport', (e) => {})\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\timagesList() {\r\n\t\t\t\treturn this.images.map(item => item.url)\r\n\t\t\t}\r\n\t\t},\r\n\t\tonNavigationBarButtonTap() {\r\n\t\t\tthis.$refs.share.open({\r\n\t\t\t\ttitle: this.info.title,\r\n\t\t\t\tshareText: this.info.title,\r\n\t\t\t\thref: \"http://www.dishaxy.com\",\r\n\t\t\t\timage: this.info.titlepic\r\n\t\t\t})\r\n\t\t},\r\n\t\tonBackPress() {\r\n\t\t\tthis.$refs.share.close()\r\n\t\t},\r\n\t\t// #ifndef APP-PLUS\r\n\t\t// 微信小程序分享\r\n\t\tonShareAppMessage(res) {\r\n\t\t\treturn {\r\n\t\t\t\ttitle: this.info.title,\r\n\t\t\t\tpath: '/pages/detail/detail?detail=' + JSON.stringify(this.info)\r\n\t\t\t}\r\n\t\t},\r\n\t\t// #endif\r\n\t\tmethods: {\r\n\t\t\t__init(id) {\r\n\t\t\t\t// 请求api\r\n\t\t\t\tthis.$H.get('/post_detail?id=' + id, {}, {\r\n\t\t\t\t\ttoken: true,\r\n\t\t\t\t\tnoCheck: true\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tthis.info = res\r\n\t\t\t\t})\r\n\t\t\t\tthis.getComments()\r\n\t\t\t},\r\n\t\t\t// 点击评论\r\n\t\t\tdoComment() {\r\n\r\n\t\t\t},\r\n\t\t\t// 点击分享\r\n\t\t\tdoShare() {\r\n\r\n\t\t\t},\r\n\t\t\t// 关注\r\n\t\t\tfollow() {\r\n\t\t\t\tthis.info.state.follow = true\r\n\t\t\t\tthis.$U.toast(\"关注成功\")\r\n\t\t\t},\r\n\t\t\t// 顶踩操作\r\n\t\t\tdoSupport(e) {\r\n\t\t\t\tif (e.type === 'support') {\r\n\t\t\t\t\t// 之前没有操作过\r\n\t\t\t\t\tif (this.info.state.type === 0) {\r\n\t\t\t\t\t\tthis.info.like_count++\r\n\t\t\t\t\t} else if (this.info.state.type === 2) {\r\n\t\t\t\t\t\tthis.info.like_count++;\r\n\t\t\t\t\t\tthis.info.unlike_count--;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn this.$U.toast(\"已操作过哦\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.info.state.type = 1\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.info.state.type === 0) {\r\n\t\t\t\t\t\tthis.info.unlike_count++\r\n\t\t\t\t\t} else if (this.info.state.type === 1) {\r\n\t\t\t\t\t\tthis.info.like_count--;\r\n\t\t\t\t\t\tthis.info.unlike_count++;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn this.$U.toast(\"已操作过哦\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.info.state.type = 2\r\n\t\t\t\t}\r\n\t\t\t\tlet msg = e.type === 'support' ? '顶' : '踩'\r\n\t\t\t\tthis.$U.toast(msg + \"成功\")\r\n\t\t\t},\r\n\t\t\t// 预览图片\r\n\t\t\tpreview(index) {\r\n\t\t\t\t// 预览图片\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: index,\r\n\t\t\t\t\turls: this.imagesList\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 提交评论\r\n\t\t\tsubmit(data) {\r\n\t\t\t\tif (data === '') {\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '评论不能为空',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '评论中...',\r\n\t\t\t\t\tmask: false\r\n\t\t\t\t});\r\n\t\t\t\tthis.$H.post('/post/comment', {\r\n\t\t\t\t\treply_id: this.reply_id,\n\t\t\t\t\treply_root: this.reply_root,\r\n\t\t\t\t\tcontent: data,\r\n\t\t\t\t\tpost_id: this.info.id\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttoken: true\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tthis.getComments()\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 获取评论列表\r\n\t\t\tgetComments() {\r\n\t\t\t\tthis.$H.get('/comment_list?pid=' + this.info.id)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tthis.comments = res\r\n\t\t\t\t\t\tuni.$emit('updateCommentsCount', {\r\n\t\t\t\t\t\t\tid: this.info.id\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 回复评论\r\n\t\t\treply(r_id, id) {\r\n\t\t\t\tthis.reply_id = id\n\t\t\t\tthis.reply_root = r_id\r\n\t\t\t\tthis.focus = true\r\n\t\t\t},\r\n\t\t\t// 输入框失去焦点\r\n\t\t\tblur() {\r\n\t\t\t\tthis.reply_id = 0\n\t\t\t\tthis.reply_root = 0\r\n\t\t\t\tthis.focus = false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\n"],"sourceRoot":""}
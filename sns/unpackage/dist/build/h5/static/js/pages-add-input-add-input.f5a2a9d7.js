(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-add-input-add-input"],{"02f3":function(t,e,n){"use strict";var i=n("ee27");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("5bf6")),o=i(n("86e5")),s={name:"UniNavBar",components:{uniStatusBar:a.default,uniIcons:o.default},props:{title:{type:String,default:""},leftText:{type:String,default:""},rightText:{type:String,default:""},leftIcon:{type:String,default:""},rightIcon:{type:String,default:""},fixed:{type:[Boolean,String],default:!1},color:{type:String,default:"#000000"},backgroundColor:{type:String,default:"#FFFFFF"},statusBar:{type:[Boolean,String],default:!1},shadow:{type:[String,Boolean],default:!0},border:{type:[String,Boolean],default:!0}},methods:{onClickLeft:function(){this.$emit("click-left")},onClickRight:function(){this.$emit("click-right")}}};e.default=s},"052d":function(t,e,n){var i;function a(){var t=0,e=plus.ios.import("PHPhotoLibrary"),n=e.authorizationStatus();return t=0===n?null:3==n?1:0,plus.ios.deleteObject(e),t}function o(){var t=0,e=plus.ios.import("AVCaptureDevice"),n=e.authorizationStatusForMediaType("vide");return t=0===n?null:3==n?1:0,plus.ios.deleteObject(e),t}function s(){var t=0,e=plus.ios.import("CLLocationManager"),n=e.locationServicesEnabled(),i=e.authorizationStatus();return t=n?0===i?null:3===i||4===i?1:0:2,plus.ios.deleteObject(e),t}function r(){var t=0,e=plus.ios.import("UIApplication"),n=e.sharedApplication(),i=0;if(n.currentUserNotificationSettings){var a=n.currentUserNotificationSettings();i=a.plusGetAttribute("types"),0==i?(t=0,console.log("推送权限没有开启")):(t=1,console.log("已经开启推送功能!")),plus.ios.deleteObject(a)}else i=n.enabledRemoteNotificationTypes(),0==i?(t=3,console.log("推送权限没有开启!")):(t=4,console.log("已经开启推送功能!"));return plus.ios.deleteObject(n),plus.ios.deleteObject(e),t}function c(){var t=0,e=plus.ios.import("CNContactStore");e.authorizationStatusForEntityType(0);return t=0===authStatus?null:3==authStatus?1:0,plus.ios.deleteObject(e),t}function u(){var t=null,e=plus.ios.import("AVAudioSession"),n=e.sharedInstance(),i=n.recordPermission();return console.log("permissionStatus:"+i),t=1970168948===i?null:1735552628===i?1:0,plus.ios.deleteObject(e),t}function l(){var t=null,e=plus.ios.import("EKEventStore"),n=e.authorizationStatusForEntityType(0);return 3==n?(t=1,console.log("日历权限已经开启")):console.log("日历权限没有开启"),plus.ios.deleteObject(e),t}function d(){var t=null,e=plus.ios.import("EKEventStore"),n=e.authorizationStatusForEntityType(1);return 3==n?(t=1,console.log("备忘录权限已经开启")):console.log("备忘录权限没有开启"),plus.ios.deleteObject(e),t}function f(t){return new Promise((function(e,n){switch(t){case"push":e(r());break;case"location":e(s());break;case"record":e(u());break;case"camera":e(o());break;case"album":e(a());break;case"contact":e(c());break;case"calendar":e(l());break;case"memo":e(d());break;default:e(0);break}}))}function p(t){return new Promise((function(e,n){plus.android.requestPermissions([t],(function(t){for(var n=0,i=0;i<t.granted.length;i++){var a=t.granted[i];console.log("已获取的权限："+a),n=1}for(i=0;i<t.deniedPresent.length;i++){var o=t.deniedPresent[i];console.log("拒绝本次申请的权限："+o),n=0}for(i=0;i<t.deniedAlways.length;i++){var s=t.deniedAlways[i];console.log("永久拒绝申请的权限："+s),n=-1}e(n)}),(function(t){console.log("result error: "+t.message),e({code:t.code,message:t.message})}))}))}function v(){if(b.isIOS){var t=plus.ios.import("UIApplication"),e=t.sharedApplication(),n=plus.ios.import("NSURL"),i=n.URLWithString("app-settings:");e.openURL(i),plus.ios.deleteObject(i),plus.ios.deleteObject(n),plus.ios.deleteObject(e)}else{var a=plus.android.importClass("android.content.Intent"),o=plus.android.importClass("android.provider.Settings"),s=plus.android.importClass("android.net.Uri"),r=plus.android.runtimeMainActivity(),c=new a;c.setAction(o.ACTION_APPLICATION_DETAILS_SETTINGS);var u=s.fromParts("package",r.getPackageName(),null);c.setData(u),r.startActivity(c)}}function h(){var t=plus.ios.import("UIApplication"),e=t.sharedApplication(),n=plus.ios.import("NSURL"),i=n.URLWithString("App-prefs:root=General");e.openURL(i),plus.ios.deleteObject(i),plus.ios.deleteObject(n),plus.ios.deleteObject(e)}n("d3b7");var b={get isIOS(){return"boolean"===typeof i?i:i="ios"===uni.getSystemInfoSync().platform},requestIOS:f,requestAndroid:p,gotoAppSetting:v,gotoiOSSetting:h};t.exports=b},"19bd":function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"uni-navbar"},[n("v-uni-view",{staticClass:"uni-navbar__content",class:{"uni-navbar--fixed":t.fixed,"uni-navbar--shadow":t.border,"uni-navbar--border":t.border},style:{"background-color":t.backgroundColor}},[t.statusBar?n("uni-status-bar"):t._e(),n("v-uni-view",{staticClass:"uni-navbar__header uni-navbar__content_view",style:{color:t.color}},[n("v-uni-view",{staticClass:"uni-navbar__header-btns uni-navbar__content_view",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onClickLeft.apply(void 0,arguments)}}},[t.leftIcon.length?n("v-uni-view",{staticClass:"uni-navbar__content_view"},[n("uni-icons",{attrs:{type:t.leftIcon,color:t.color,size:"24"}})],1):t._e(),t.leftText.length?n("v-uni-view",{staticClass:"uni-navbar-btn-text uni-navbar__content_view",class:{"uni-navbar-btn-icon-left":!t.leftIcon.length}},[t._v(t._s(t.leftText))]):t._e(),t._t("left")],2),n("v-uni-view",{staticClass:"uni-navbar__header-container uni-navbar__content_view"},[t.title.length?n("v-uni-view",{staticClass:"uni-navbar__header-container-inner uni-navbar__content_view"},[t._v(t._s(t.title))]):t._e(),t._t("default")],2),n("v-uni-view",{staticClass:"uni-navbar__header-btns uni-navbar__content_view",class:t.title.length?"uni-navbar__header-btns-right":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onClickRight.apply(void 0,arguments)}}},[t.rightIcon.length?n("v-uni-view",{staticClass:"uni-navbar__content_view"},[n("uni-icons",{attrs:{type:t.rightIcon,color:t.color,size:"24"}})],1):t._e(),t.rightText.length&&!t.rightIcon.length?n("v-uni-view",{staticClass:"uni-navbar-btn-text uni-navbar__content_view"},[t._v(t._s(t.rightText))]):t._e(),t._t("right")],2)],1)],1),t.fixed?n("v-uni-view",{staticClass:"uni-navbar__placeholder"},[t.statusBar?n("uni-status-bar"):t._e(),n("v-uni-view",{staticClass:"uni-navbar__placeholder-view"})],1):t._e()],1)},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},"1b0a":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'.uni-navbar__content[data-v-bf6ac1ae]{display:block;position:relative;width:100%;background-color:#fff;overflow:hidden}.uni-navbar__content .uni-navbar__content_view[data-v-bf6ac1ae]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-navbar__header[data-v-bf6ac1ae]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;width:100%;height:44px;line-height:44px;font-size:16px}.uni-navbar__header-btns[data-v-bf6ac1ae]{display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-flex-shrink:0;flex-shrink:0;width:%?120?%;padding:0 %?12?%}.uni-navbar__header-btns[data-v-bf6ac1ae]:first-child{padding-left:0}.uni-navbar__header-btns[data-v-bf6ac1ae]:last-child{width:%?60?%}.uni-navbar__header-btns-right[data-v-bf6ac1ae]:last-child{width:%?120?%;text-align:right;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;flex-direction:row-reverse}.uni-navbar__header-container[data-v-bf6ac1ae]{width:100%;margin:0 %?10?%}.uni-navbar__header-container-inner[data-v-bf6ac1ae]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;font-size:%?30?%}.uni-navbar__placeholder-view[data-v-bf6ac1ae]{height:44px}.uni-navbar--fixed[data-v-bf6ac1ae]{position:fixed;z-index:998}.uni-navbar--shadow[data-v-bf6ac1ae]{box-shadow:0 1px 6px #ccc}.uni-navbar--border[data-v-bf6ac1ae]:after{position:absolute;z-index:3;bottom:0;left:0;right:0;height:1px;content:"";-webkit-transform:scaleY(.5);transform:scaleY(.5);background-color:#e5e5e5}',""]),t.exports=e},"1c72":function(t,e,n){"use strict";n.r(e);var i=n("f505"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"1e9e":function(t,e,n){"use strict";n.r(e);var i=n("5d3f"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"298d":function(t,e,n){"use strict";n.r(e);var i=n("4e65"),a=n("cd73");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("95a9");var s,r=n("f0c5"),c=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"1cd4371d",null,!1,i["a"],s);e["default"]=c.exports},"37de":function(t,e,n){"use strict";n.r(e);var i=n("19bd"),a=n("8c35");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("3ee0");var s,r=n("f0c5"),c=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"bf6ac1ae",null,!1,i["a"],s);e["default"]=c.exports},"3ee0":function(t,e,n){"use strict";var i=n("c4ea"),a=n.n(i);a.a},4988:function(t,e,n){"use strict";var i=n("ca80"),a=n.n(i);a.a},"4a5e":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".footer-btn[data-v-29cee567]{width:%?86?%;height:%?86?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-content:center;align-content:center;font-size:%?50?%}",""]),t.exports=e},"4e65":function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"px-2"},[t.show?n("v-uni-view",{staticClass:"uni-uploader"},[n("v-uni-view",{staticClass:"uni-uploader-head"},[n("v-uni-view",{staticClass:"uni-uploader-title"},[t._v("点击可预览选好的图片")]),n("v-uni-view",{staticClass:"uni-uploader-info"},[t._v(t._s(t.imageList.length)+"/9")])],1),n("v-uni-view",{staticClass:"uni-uploader-body"},[n("v-uni-view",{staticClass:"uni-uploader__files"},[t._l(t.imageList,(function(e,i){return[n("v-uni-view",{key:i+"_0",staticClass:"uni-uploader__file position-relative"},[n("v-uni-image",{staticClass:"uni-uploader__img rounded",attrs:{src:e.thumb,"data-src":e.thumb,mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._previewImage(i)}}}),n("v-uni-view",{staticClass:"position-absolute top-0 right-0 rounded",staticStyle:{padding:"0 15rpx","background-color":"rgba(0,0,0,0.5)"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteImage(i)}}},[n("v-uni-text",{staticClass:"iconfont icon-shanchu text-white"})],1)],1)]})),n("v-uni-view",{staticClass:"uni-uploader__input-box rounded"},[n("v-uni-view",{staticClass:"uni-uploader__input",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}})],1)],2)],1)],1):t._e()],1)},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},"56e4":function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"uni-status-bar",style:{height:t.statusBarHeight}},[t._t("default")],2)},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},"5bf6":function(t,e,n){"use strict";n.r(e);var i=n("56e4"),a=n("1e9e");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("4988");var s,r=n("f0c5"),c=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"a9d4525a",null,!1,i["a"],s);e["default"]=c.exports},"5d3f":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=uni.getSystemInfoSync().statusBarHeight+"px",a={name:"UniStatusBar",data:function(){return{statusBarHeight:i}}};e.default=a},8850:function(t,e,n){"use strict";n.r(e);var i=n("8c6e"),a=n("1c72");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("c275");var s,r=n("f0c5"),c=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"29cee567",null,!1,i["a"],s);e["default"]=c.exports},"8c35":function(t,e,n){"use strict";n.r(e);var i=n("02f3"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},"8c6e":function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("uni-nav-bar",{attrs:{"left-icon":"back",statusBar:!0,border:!1},on:{"click-left":function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"flex align-center justify-center w-100",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeIsopen.apply(void 0,arguments)}}},[t._v(t._s(t.isopenText)),n("v-uni-text",{staticClass:"iconfont icon-shezhi"})],1)],1),n("v-uni-textarea",{staticClass:"uni-textarea px-2",attrs:{placeholder:"说一句话吧"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t.post_class_index>=0?[n("v-uni-view",{staticClass:"font-md px-2 py-1 flex",attrs:{show:t.showCat}},[n("v-uni-view",{staticClass:"bg-main text-white border px-3 py main-color main-border-color flex align-center justify-center",staticStyle:{"border-radius":"50rpx"}},[n("v-uni-text",{staticClass:"iconfont icon-caidan mr-1"}),t._v(t._s(t.post_class_name?"所属分类："+t.post_class_name:"请选择分类"))],1)],1)]:t._e(),t.topic.id>0?[n("v-uni-view",{staticClass:"font-md px-2 py-1 flex"},[n("v-uni-view",{staticClass:"bg-main text-white border px-3 py main-color main-border-color flex align-center justify-center",staticStyle:{"border-radius":"50rpx"}},[n("v-uni-text",{staticClass:"iconfont icon-huati mr-1"}),t._v(t._s(t.topic.title?"所属话题："+t.topic.title:"请选择话题"))],1)],1)]:t._e(),n("upload-image",{ref:"uploadImage",attrs:{show:!0,list:t.imageList},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeImage.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"fixed-bottom bg-white flex align-center",staticStyle:{height:"85rpx"}},[n("v-uni-picker",{attrs:{mode:"selector",range:t.range},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.choosePostClass.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"iconfont icon-caidan footer-btn animated",attrs:{"hover-class":"jello"}})],1),n("v-uni-view",{staticClass:"iconfont icon-huati footer-btn animated",attrs:{"hover-class":"jello"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseTopic.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"iconfont icon-tupian footer-btn animated",attrs:{"hover-class":"jello"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.iconClickEvent("uploadImage")}}}),n("v-uni-view",{staticClass:"bg-main text-white ml-auto flex justify-center align-center rounded mr-2 animated",staticStyle:{width:"140rpx",height:"60rpx"},attrs:{"hover-class":"jello"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("发送")])],1)],2)},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},"95a9":function(t,e,n){"use strict";var i=n("9791"),a=n.n(i);a.a},9791:function(t,e,n){var i=n("c407");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("6150b292",i,!0,{sourceMap:!1,shadowMode:!1})},"9a0e":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".uni-status-bar[data-v-a9d4525a]{display:block;width:100%;height:20px;height:0}",""]),t.exports=e},aae7:function(t,e,n){var i=n("4a5e");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("1aae02a9",i,!0,{sourceMap:!1,shadowMode:!1})},c275:function(t,e,n){"use strict";var i=n("aae7"),a=n.n(i);a.a},c407:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".cell-pd[data-v-1cd4371d]{padding:%?22?% %?30?%}.list-pd[data-v-1cd4371d]{margin-top:%?50?%}",""]),t.exports=e},c4ea:function(t,e,n){var i=n("1b0a");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("9548c412",i,!0,{sourceMap:!1,shadowMode:!1})},ca80:function(t,e,n){var i=n("9a0e");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("43b677c6",i,!0,{sourceMap:!1,shadowMode:!1})},cd73:function(t,e,n){"use strict";n.r(e);var i=n("dcd0"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},dcd0:function(t,e,n){"use strict";var i=n("ee27");n("4160"),n("d81d"),n("a434"),n("d3b7"),n("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var a=i(n("c964")),o=i(n("052d")),s=[["camera"],["album"],["camera","album"]],r=[["compressed"],["original"],["compressed","original"]],c={props:{list:Array,show:{type:Boolean,default:!0}},data:function(){return{title:"choose/previewImage",imageList:[],sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}},created:function(){this.imageList=this.list},destroyed:function(){this.imageList=[],this.sourceTypeIndex=2,this.sourceType=["拍照","相册","拍照或相册"],this.sizeTypeIndex=2,this.sizeType=["压缩","原图","压缩或原图"],this.countIndex=8},methods:{deleteImage:function(t){var e=this;uni.showModal({title:"提示",content:"是否要删除该图片？",showCancel:!0,cancelText:"不删除",confirmText:"删除",success:function(n){n.confirm&&(e.imageList.splice(t,1),e.$emit("change",e.imageList))}})},chooseImage:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(9!==this.imageList.length){t.next=7;break}return t.next=3,this.isFullImg();case 3:if(e=t.sent,console.log("是否继续?",e),e){t.next=7;break}return t.abrupt("return");case 7:uni.chooseImage({sourceType:s[this.sourceTypeIndex],sizeType:r[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:function(t){t.tempFilePaths.forEach((function(t){n.$H.upload("/upload/image",{filePath:t,name:"files[]",token:!0}).then((function(t){console.log(t),n.imageList.push(t.data[0]),n.$emit("change",n.imageList)}))}))},fail:function(t){}});case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),isFullImg:function(){var t=this;return new Promise((function(e){uni.showModal({content:"已经有9张图片了,是否清空现有图片？",success:function(n){n.confirm?(t.imageList=[],e(!0)):e(!1)},fail:function(){e(!1)}})}))},_previewImage:function(t){var e=this.imageList.map((function(t){return t.big}));uni.previewImage({current:e[t],urls:e})},checkPermission:function(t){var e=this;return(0,a.default)(regeneratorRuntime.mark((function n(){var i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=t?t-1:e.sourceTypeIndex,!o.default.isIOS){n.next=7;break}return n.next=4,o.default.requestIOS(s[i][0]);case 4:n.t0=n.sent,n.next=10;break;case 7:return n.next=9,o.default.requestAndroid(0===i?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");case 9:n.t0=n.sent;case 10:return a=n.t0,null===a||1===a?a=1:uni.showModal({content:"没有开启权限",confirmText:"设置",success:function(t){t.confirm&&o.default.gotoAppSetting()}}),n.abrupt("return",a);case 13:case"end":return n.stop()}}),n)})))()}}};e.default=c},f505:function(t,e,n){"use strict";var i=n("ee27");n("a15b"),n("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("37de")),o=i(n("298d")),s=["所有人可见","好友可见","仅自己可见"],r={components:{uniNavBar:a.default,uploadImage:o.default},data:function(){return{content:"",imageList:[],showBack:!1,isopen:0,topic:{id:0,title:""},post_class_list:[],post_class_index:-1}},computed:{show:function(){return this.imageList.length>0},isopenText:function(){return s[this.isopen]},range:function(){return this.post_class_list.map((function(t){return t.name}))},post_class_id:function(){if(-1!==this.post_class_index)return this.post_class_list[this.post_class_index].id},post_class_name:function(){if(-1!==this.post_class_index)return this.post_class_list[this.post_class_index].name},imgListIds:function(){return this.imageList.map((function(t){return t.id}))}},onBackPress:function(){var t=this;if((""!==this.content||this.imageList.length>0)&&!this.showBack)return uni.showModal({content:"是否要保存为草稿？",showCancel:!0,cancelText:"不保存",confirmText:"保存",success:function(e){e.confirm?t.store():uni.removeStorage({key:"add-input"}),uni.navigateBack({delta:1})}}),this.showBack=!0,!0},onLoad:function(){var t=this;uni.getStorage({key:"add-input",success:function(e){if(e.data){var n=JSON.parse(e.data);t.content=n.content,t.imageList=n.imageList}}}),uni.$on("chooseTopic",(function(e){t.topic.id=e.id,t.topic.title=e.title})),this.getPostClass()},beforeDestroy:function(){uni.$off("chooseTopic",(function(t){}))},methods:{submit:function(){var t=this;uni.showLoading({title:"发布中...",mask:!1}),this.$H.post("/post/create",{image:this.imgListIds.join(","),content:this.content,see_type:this.isopen,topic_id:this.topic.id,cat_id:this.post_class_id},{token:!0}).then((function(e){uni.hideLoading(),uni.$emit("updateIndex"),uni.showToast({title:"发布成功",icon:"none"}),t.showBack=!0,uni.navigateBack({delta:1})})).catch((function(t){uni.hideLoading()}))},getPostClass:function(){var t=this;this.$H.get("/cat").then((function(e){t.post_class_list=e}))},choosePostClass:function(t){this.post_class_index=t.detail.value},chooseTopic:function(){uni.navigateTo({url:"../topic-nav/topic-nav?choose=true"})},changeIsopen:function(){var t=this;uni.showActionSheet({itemList:s,success:function(e){t.isopen=e.tapIndex}})},iconClickEvent:function(t){switch(t){case"uploadImage":this.$refs.uploadImage.chooseImage();break}},goBack:function(){uni.navigateBack({delta:1})},changeImage:function(t){this.imageList=t},store:function(){var t={content:this.content,imageList:this.imageList};uni.setStorage({key:"add-input",data:JSON.stringify(t)})}}};e.default=r}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-detail-detail"],{1187:function(t,e,n){"use strict";n.r(e);var i=n("dce7"),o=n("9649");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"2f977094",null,!1,i["a"],s);e["default"]=u.exports},1219:function(t,e,n){"use strict";var i=n("ee27");n("4e82"),n("d3b7"),n("ac1f"),n("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var o=i(n("c964")),a=i(n("63f9")),s={components:{uniPopup:a.default},data:function(){return{title:"",shareText:"",href:"",image:"",shareType:0,providerList:[]}},computed:{isDisableButton:function(){return function(t){return 0===this.shareType&&"qq"===t.id||5===this.shareType&&"分享到微信好友"!==t.name}}},onShareAppMessage:function(){return{title:this.shareText?this.shareText:"欢迎体验uni-app",path:"/pages/tabBar/component/component",imageUrl:this.image?this.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png"}},beforeDestroy:function(){this.shareText="uni-app可以同时发布成原生App、小程序、H5，邀请你一起体验！",this.href="https://uniapp.dcloud.io",this.image=""},onReady:function(){var t=this;uni.getProvider({service:"share",success:function(e){console.log(e);for(var n=[],i=0;i<e.provider.length;i++)switch(e.provider[i]){case"weixin":n.push({name:"微信好友",icon:"icon-weixin",color:"bg-success",id:"weixin",sort:0}),n.push({name:"朋友圈",icon:"icon-huati",color:"bg-dark",id:"weixin",type:"WXSenceTimeline",sort:1});break;case"sinaweibo":n.push({name:"新浪微博",icon:"icon-xinlangweibo",color:"bg-danger",id:"sinaweibo",sort:2});break;case"qq":n.push({name:"QQ好友",icon:"icon-QQ",color:"bg-primary",id:"qq",sort:3});break;default:break}t.providerList=n.sort((function(t,e){return t.sort-e.sort}))},fail:function(t){uni.showModal({content:"获取分享通道失败",showCancel:!1})}})},methods:{open:function(t){this.title=t.title,this.shareText=t.shareText,this.href=t.href,this.image=t.image,this.$refs.popup.open()},close:function(){this.$refs.popup.close()},share:function(t){var e=this;return(0,o.default)(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("分享通道:"+t.id+"； 分享类型:"+e.shareType),e.shareText||1!==e.shareType&&0!==e.shareType){n.next=4;break}return uni.showModal({content:"分享内容不能为空",showCancel:!1}),n.abrupt("return");case 4:if(e.image||2!==e.shareType&&0!==e.shareType){n.next=7;break}return uni.showModal({content:"分享图片不能为空",showCancel:!1}),n.abrupt("return");case 7:"qq"!==t.id&&"sinaweibo"!==t.id||(e.shareType=1),i={provider:t.id,scene:t.type&&"WXSenceTimeline"===t.type?"WXSenceTimeline":"WXSceneSession",type:e.shareType,success:function(t){console.log("success",t),uni.showModal({content:"分享成功",showCancel:!1})},fail:function(t){console.log("fail",t),uni.showModal({content:t.errMsg,showCancel:!1})},complete:function(){console.log("分享操作结束!")}},n.t0=e.shareType,n.next=0===n.t0?12:1===n.t0?17:2===n.t0?19:5===n.t0?21:25;break;case 12:return i.summary=e.shareText,i.imageUrl=e.image,i.title="欢迎体验uniapp",i.href="https://uniapp.dcloud.io",n.abrupt("break",26);case 17:return i.summary=e.shareText,n.abrupt("break",26);case 19:return i.imageUrl=e.image,n.abrupt("break",26);case 21:return i.imageUrl=e.image?e.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png",i.title="欢迎体验uniapp",i.miniProgram={id:"gh_33446d7f7a26",path:"/pages/tabBar/component/component",webUrl:"https://uniapp.dcloud.io",type:0},n.abrupt("break",26);case 25:return n.abrupt("break",26);case 26:if(0!==i.type||"iOS"!==plus.os.name){n.next=30;break}return n.next=29,e.compress();case 29:i.imageUrl=n.sent;case 30:1===i.type&&"qq"===i.provider&&(i.href="https://uniapp.dcloud.io",i.title="欢迎体验uniapp"),uni.share(i);case 32:case"end":return n.stop()}}),n)})))()},compress:function(){console.log("开始压缩");var t=this.image;return new Promise((function(e){var n=plus.io.convertAbsoluteFileSystem(t.replace("file://",""));console.log("after"+n),plus.io.resolveLocalFileSystemURL(n,(function(n){n.file((function(n){console.log("getFile:"+JSON.stringify(n)),n.size>20480&&plus.zip.compressImage({src:t,dst:t.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG"),width:"10%",height:"10%",quality:1,overwrite:!0},(function(n){console.log("success zip****"+n.size);var i=t.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG");e(i)}),(function(t){uni.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})}))}))}),(function(t){console.log("Resolve file URL failed: "+t.message),uni.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})}))}))}}};e.default=s},"14ed":function(t,e,n){"use strict";n.r(e);var i=n("4d14"),o=n("dc4a");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"d95a1314",null,!1,i["a"],s);e["default"]=u.exports},1972:function(t,e,n){"use strict";n.r(e);var i=n("1219"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"32fe":function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".uni-popup[data-v-c1b7d0b4]{position:fixed;top:0;top:0;bottom:0;left:0;right:0;z-index:9998;overflow:hidden}.uni-popup__mask[data-v-c1b7d0b4]{position:absolute;top:0;bottom:0;left:0;right:0;z-index:998;background:rgba(0,0,0,.4);opacity:0}.uni-popup__mask.ani[data-v-c1b7d0b4]{-webkit-transition:all .3s;transition:all .3s}.uni-popup__mask.uni-bottom[data-v-c1b7d0b4],\n.uni-popup__mask.uni-center[data-v-c1b7d0b4],\n.uni-popup__mask.uni-top[data-v-c1b7d0b4]{opacity:1}.uni-popup__wrapper[data-v-c1b7d0b4]{position:absolute;z-index:999;box-sizing:border-box}.uni-popup__wrapper.ani[data-v-c1b7d0b4]{-webkit-transition:all .3s;transition:all .3s}.uni-popup__wrapper.top[data-v-c1b7d0b4]{top:0;left:0;width:100%;-webkit-transform:translateY(-100%);transform:translateY(-100%)}.uni-popup__wrapper.bottom[data-v-c1b7d0b4]{bottom:0;left:0;width:100%;-webkit-transform:translateY(100%);transform:translateY(100%)}.uni-popup__wrapper.center[data-v-c1b7d0b4]{width:100%;height:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-transform:scale(1.2);transform:scale(1.2);opacity:0}.uni-popup__wrapper-box[data-v-c1b7d0b4]{position:relative;box-sizing:border-box}.uni-popup__wrapper.uni-custom .uni-popup__wrapper-box[data-v-c1b7d0b4]{\n\t/* padding: 30upx; */background:#fff}.uni-popup__wrapper.uni-custom.center .uni-popup__wrapper-box[data-v-c1b7d0b4]{position:relative;max-width:80%;max-height:80%;overflow-y:scroll}.uni-popup__wrapper.uni-custom.bottom .uni-popup__wrapper-box[data-v-c1b7d0b4],\n.uni-popup__wrapper.uni-custom.top .uni-popup__wrapper-box[data-v-c1b7d0b4]{width:100%;max-height:500px;overflow-y:scroll}.uni-popup__wrapper.uni-bottom[data-v-c1b7d0b4],\n.uni-popup__wrapper.uni-top[data-v-c1b7d0b4]{-webkit-transform:translateY(0);transform:translateY(0)}.uni-popup__wrapper.uni-center[data-v-c1b7d0b4]{-webkit-transform:scale(1);transform:scale(1);opacity:1}",""]),t.exports=e},3791:function(t,e,n){var i=n("32fe");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=n("4f06").default;o("a2fe8540",i,!0,{sourceMap:!1,shadowMode:!1})},"3d0a":function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.showPopup?n("v-uni-view",{staticClass:"uni-popup"},[n("v-uni-view",{staticClass:"uni-popup__mask",class:[t.ani,t.animation?"ani":"",t.custom?"":"uni-custom"],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.close(!0)}}}),n("v-uni-view",{staticClass:"uni-popup__wrapper",class:[t.type,t.ani,t.animation?"ani":"",t.custom?"":"uni-custom"],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.close(!0)}}},[n("v-uni-view",{staticClass:"uni-popup__wrapper-box",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.clear.apply(void 0,arguments)}}},[t._t("default")],2)],1)],1):t._e()},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},"4d14":function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("common-list",{attrs:{item:t.info,isdetail:!0},on:{follow:function(e){arguments[0]=e=t.$handleEvent(e),t.follow.apply(void 0,arguments)},doSupport:function(e){arguments[0]=e=t.$handleEvent(e),t.doSupport.apply(void 0,arguments)},doComment:function(e){arguments[0]=e=t.$handleEvent(e),t.doComment.apply(void 0,arguments)},doShare:function(e){arguments[0]=e=t.$handleEvent(e),t.doShare.apply(void 0,arguments)}}}),n("divider"),n("v-uni-view",{staticClass:"p-2 font-md font-weight-bold"},[t._v("最新评论 "+t._s(t.info.comment_count))]),n("v-uni-view",{staticClass:"px-2"},t._l(t.comments,(function(e,i){return n("v-uni-view",{key:i},[n("v-uni-view",{staticClass:"uni-comment-list flex w-100"},[n("v-uni-view",{staticClass:"uni-comment-face"},[n("v-uni-image",{staticClass:"w-100",attrs:{mode:"widthFix",src:t._f("formatAvatar")(e.avatar)}})],1),n("v-uni-view",{staticClass:"uni-comment-body"},[n("v-uni-view",{staticClass:"uni-comment-top"},[n("v-uni-text",[t._v(t._s(e.username))])],1),n("v-uni-view",{staticClass:"uni-comment-content",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.reply(e.id,e.id)}}},[t._v(t._s(e.content))]),n("v-uni-view",{staticClass:"uni-comment-date"},[n("v-uni-view",[t._v(t._s(t._f("formatTime")(e.created_at)))])],1)],1)],1),e.reply.length>0?t._l(e.reply,(function(i,o){return n("v-uni-view",{key:o,staticClass:"uni-comment-list"},[n("v-uni-view",{staticStyle:{width:"60rpx"}}),n("v-uni-view",{staticClass:"flex w-100 bg-light rounded p-2"},[n("v-uni-view",{staticClass:"uni-comment-face"},[n("v-uni-image",{staticClass:"w-100",attrs:{mode:"widthFix",src:t._f("formatAvatar")(i.avatar)}})],1),n("v-uni-view",{staticClass:"uni-comment-body"},[n("v-uni-view",{staticClass:"uni-comment-top"},[n("v-uni-text",[t._v(t._s(i.username))])],1),n("v-uni-view",{staticClass:"uni-comment-content",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.reply(e.id,i.id)}}},[t._v(t._s(i.content))]),n("v-uni-view",{staticClass:"uni-comment-date"},[n("v-uni-view",[t._v(t._s(t._f("formatTime")(i.created_at)))])],1)],1)],1)],1)})):t._e()],2)})),1),n("v-uni-view",{staticStyle:{height:"100rpx"}}),n("bottom-input",{attrs:{focus:t.focus},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.blur.apply(void 0,arguments)},submit:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}}),n("more-share",{ref:"share"})],1)},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},"63f9":function(t,e,n){"use strict";n.r(e);var i=n("3d0a"),o=n("69d3");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("85a9");var s,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"c1b7d0b4",null,!1,i["a"],s);e["default"]=u.exports},"69d3":function(t,e,n){"use strict";n.r(e);var i=n("f39e"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"85a9":function(t,e,n){"use strict";var i=n("3791"),o=n.n(i);o.a},"88e6":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={props:{focus:{type:Boolean,default:!1}},data:function(){return{content:""}},methods:{submit:function(){if(""===this.content)return uni.showToast({title:"消息不能为空",icon:"none"});this.$emit("submit",this.content),this.content=""}}};e.default=i},9649:function(t,e,n){"use strict";n.r(e);var i=n("88e6"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"9be6":function(t,e,n){"use strict";n.r(e);var i=n("bca7e"),o=n("1972");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"8472471e",null,!1,i["a"],s);e["default"]=u.exports},bc09:function(t,e,n){"use strict";var i=n("ee27");n("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n("2f50")),a=i(n("1187")),s=i(n("9be6")),r=i(n("4096")),u={components:{commonList:o.default,bottomInput:a.default,moreShare:s.default},filters:{formatTime:function(t){return r.default.gettime(t)},formatAvatar:function(t){return""==t?"/static/default.jpg":t}},data:function(){return{info:{image:[],state:{}},images:[],comments:[],focus:!1,reply_id:0,reply_root:0}},onLoad:function(t){var e=this;t.id&&this.__init(t.id),uni.$on("updateFollowOrSupport",(function(t){switch(t.type){case"follow":e.follow();break;case"support":e.doSupport(t.data);break}}))},onUnload:function(){uni.$off("updateFollowOrSupport",(function(t){}))},computed:{imagesList:function(){return this.images.map((function(t){return t.url}))}},onNavigationBarButtonTap:function(){this.$refs.share.open({title:this.info.title,shareText:this.info.title,href:"http://www.dishaxy.com",image:this.info.titlepic})},onBackPress:function(){this.$refs.share.close()},onShareAppMessage:function(t){return{title:this.info.title,path:"/pages/detail/detail?detail="+JSON.stringify(this.info)}},methods:{__init:function(t){var e=this;this.$H.get("/post_detail?id="+t,{},{token:!0,noCheck:!0}).then((function(t){e.info=t})),this.getComments()},doComment:function(){},doShare:function(){},follow:function(){this.info.state.follow=!0,this.$U.toast("关注成功")},doSupport:function(t){if("support"===t.type){if(0===this.info.state.type)this.info.like_count++;else{if(2!==this.info.state.type)return this.$U.toast("已操作过哦");this.info.like_count++,this.info.unlike_count--}this.info.state.type=1}else{if(0===this.info.state.type)this.info.unlike_count++;else{if(1!==this.info.state.type)return this.$U.toast("已操作过哦");this.info.like_count--,this.info.unlike_count++}this.info.state.type=2}var e="support"===t.type?"顶":"踩";this.$U.toast(e+"成功")},preview:function(t){uni.previewImage({current:t,urls:this.imagesList})},submit:function(t){var e=this;if(""===t)return uni.showToast({title:"评论不能为空",icon:"none"});uni.showLoading({title:"评论中...",mask:!1}),this.$H.post("/post/comment",{reply_id:this.reply_id,reply_root:this.reply_root,content:t,post_id:this.info.id},{token:!0}).then((function(t){uni.hideLoading(),e.getComments()})).catch((function(t){uni.hideLoading()}))},getComments:function(){var t=this;this.$H.get("/comment_list?pid="+this.info.id).then((function(e){t.comments=e,uni.$emit("updateCommentsCount",{id:t.info.id})}))},reply:function(t,e){this.reply_id=e,this.reply_root=t,this.focus=!0},blur:function(){this.reply_id=0,this.reply_root=0,this.focus=!1}}};e.default=u},bca7e:function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("uni-popup",{ref:"popup",attrs:{type:"bottom"}},[n("v-uni-view",{staticClass:"text-center py-2 font-md border-bottom border-light-secondary"},[t._v("分享到")]),n("v-uni-view",{staticClass:"flex align-center"},t._l(t.providerList,(function(e,i){return n("v-uni-view",{key:i,staticClass:"flex-1 flex flex-column align-center justify-center py-2",attrs:{"hover-class":"bg-light"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.share(e)}}},[n("v-uni-view",{staticClass:"iconfont text-white flex align-center justify-center font-lg rounded-circle",class:e.icon+" "+e.color,staticStyle:{width:"100rpx",height:"100rpx"}}),n("v-uni-text",{staticClass:"font-sm mt-1 text-muted"},[t._v(t._s(e.name))])],1)})),1),n("v-uni-view",{staticClass:"text-center py-2 font-md border-top border-light-secondary",attrs:{"hover-class":"bg-light"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.close()}}},[t._v("取消")])],1)},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},dc4a:function(t,e,n){"use strict";n.r(e);var i=n("bc09"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},dce7:function(t,e,n){"use strict";var i,o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"fixed-bottom flex align-center border-top bg-white",staticStyle:{height:"100rpx"}},[n("v-uni-input",{staticClass:"flex-1 rounded bg-light ml-2",staticStyle:{padding:"5rpx"},attrs:{type:"text",focus:t.focus,placeholder:"文明发言"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.$emit("blur")}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("v-uni-view",{staticClass:"iconfont icon-fabu flex align-center justify-center font-lg animated",staticStyle:{width:"100rpx"},attrs:{"hover-class":"jello text-main"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}})],1)},a=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},f39e:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"UniPopup",props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},custom:{type:Boolean,default:!1},maskClick:{type:Boolean,default:!0},show:{type:Boolean,default:!0}},data:function(){return{ani:"",showPopup:!1}},watch:{show:function(t){t?this.open():this.close()}},created:function(){},methods:{clear:function(){},open:function(){var t=this;this.$emit("change",{show:!0}),this.showPopup=!0,this.$nextTick((function(){setTimeout((function(){t.ani="uni-"+t.type}),30)}))},close:function(t){var e=this;!this.maskClick&&t||(this.$emit("change",{show:!1}),this.ani="",this.$nextTick((function(){setTimeout((function(){e.showPopup=!1}),300)})))}}};e.default=i}}]);